<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Christmas House Tour - ArchViz Test</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <style>
    body { margin: 0; }
  </style>
</head>

<body>
<a-scene>

  <!-- ASSETS -->
  <a-assets>
    <img id="p1" src="assets/front-1.jpeg">
    <img id="p2" src="assets/front-2.jpeg">
    <img id="p3" src="assets/left.jpeg">
    <img id="p4" src="assets/back-1.jpeg">
    <img id="p5" src="assets/back-2.jpeg">
    <img id="p6" src="assets/right.jpeg">
  </a-assets>

  <!-- SKY (ambiente atual) -->
  <a-sky
    id="sky"
    src="#p1"
    rotation="0 -90 0"
    material="opacity: 1"
    animation__fadeout="property: material.opacity; to: 0; dur: 600; startEvents: fadeOut"
    animation__fadein="property: material.opacity; to: 1; dur: 600; startEvents: fadeIn">
  </a-sky>

  <!-- CÂMERA -->
  <a-camera id="camera" position="0 1.6 0" look-controls wasd-controls="enabled: false"></a-camera>

  <!-- HOTSPOT VISUAL (opcional) -->
  <a-circle
    id="hotspot"
    position="0 1.5 -3"
    radius="0.22"
    rotation="0 180 0"
    material="shader: flat; color: #00BFFF">
  </a-circle>

</a-scene>

<script>
  // Lista de panoramas (ambientes)
  const ambientes = [
    { id: 'p1', rotacao: 0 },
    { id: 'p2', rotacao: 90 },
    { id: 'p3', rotacao: 180 },
    { id: 'p4', rotacao: -90 },
    { id: 'p5', rotacao: 0 },
    { id: 'p6', rotacao: 0 }
  ];

  let indiceAtual = 0;

  const sky = document.querySelector('#sky');
  const camera = document.querySelector('#camera');

  // Função para mudar de ambiente
  function mudarAmbiente(novoIndice) {
    // Fade out
    sky.emit('fadeOut');

    setTimeout(() => {
      indiceAtual = novoIndice;
      sky.setAttribute('src', '#' + ambientes[indiceAtual].id);
      camera.setAttribute('rotation', `0 ${ambientes[indiceAtual].rotacao} 0`);
      // Fade in
      sky.emit('fadeIn');
    }, 600);
  }

  // Eventos de teclado
  document.addEventListener('keydown', (event) => {
    if(event.key === 'n' || event.key === 'N') {
      // Próximo ambiente
      const proximo = (indiceAtual + 1) % ambientes.length;
      mudarAmbiente(proximo);
    }
    if(event.key === 'p' || event.key === 'P') {
      // Ambiente anterior
      const anterior = (indiceAtual - 1 + ambientes.length) % ambientes.length;
      mudarAmbiente(anterior);
    }
  });
</script>

</body>
</html>
